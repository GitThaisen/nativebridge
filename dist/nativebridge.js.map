{"version":3,"sources":["webpack://nativebridge/webpack/universalModuleDefinition","webpack://nativebridge/webpack/bootstrap","webpack://nativebridge/./index.js"],"names":["root","factory","exports","module","define","amd","window","installedModules","__webpack_require__","moduleId","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","r","value","n","__esModule","object","property","prototype","hasOwnProperty","p","s","on","off","once","emit","validateRpcInput","rpc","_ref2","topic","data","resolve","reject","_ref2$timeout","timeout","undefined","DEFAULT_TIMEOUT","timedout","timer","setTimeout","Error","args","clearTimeout","errors","JSON","stringify","e","setupNativeLink","destroy","keys","events","forEach","handler","removeEventListener","onNative","push","filter","fn","length","newHandler","arguments","webkit","messageHandlers","nativebridgeiOS","postMessage","NativeBridgeAndroid","send","_ref","TypeError","_typeof","_ref3","_ref3$detail","detail","addEventListener"],"mappings":"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","file":"nativebridge.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"nativebridge\"] = factory();\n\telse\n\t\troot[\"nativebridge\"] = factory();\n})(window, function() {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const DEFAULT_TIMEOUT = 1000\nexport const events = {}\n\nexport function on (topic, handler) {\n  if (typeof topic !== 'string') {\n    throw new Error('topic must be a string')\n  }\n  if (typeof handler !== 'function') {\n    throw new Error('Handler must be of topic function')\n  }\n  (events[topic] = events[topic] || []).push(handler)\n}\n\nexport function off (topic, handler) {\n  if (typeof topic !== 'string') {\n    throw new Error('topic must be a string')\n  }\n  events[topic] = (events[topic] || []).filter((fn) => handler && fn !== handler)\n  if (events[topic].length === 0) {\n    delete events[topic]\n  }\n}\n\nexport function once (topic, handler) {\n  if (typeof topic !== 'string') {\n    throw new Error('type must be a string')\n  }\n  if (typeof handler !== 'function') {\n    throw new Error('Handler must be of type function')\n  }\n  const newHandler = function (...args) {\n    off(topic, newHandler)\n    handler(...args)\n  }\n  on(topic, newHandler)\n}\n\nexport function emit (topic, data = {}) {\n  if (window.webkit && window.webkit.messageHandlers) {\n    window.webkit.messageHandlers.nativebridgeiOS.postMessage({topic, data})\n  } else if (window.NativeBridgeAndroid) {\n    window.NativeBridgeAndroid.send(JSON.stringify({topic, data}))\n  } else {\n    throw new Error('No native bridge defined')\n  }\n}\n\nexport function validateRpcInput ({topic, data, resolve, reject, timeout}) {\n  if (typeof topic !== 'string') {\n    throw TypeError('topic argument must be a String')\n  }\n  if (data === null || typeof data !== 'object') {\n    throw TypeError('data argument must be an Object')\n  }\n  if (typeof resolve !== 'function') {\n    throw new TypeError('resolve must be a function')\n  }\n  if (typeof reject !== 'function') {\n    throw new TypeError('resolve must be a function')\n  }\n  if (typeof timeout !== 'number') {\n    throw new TypeError('timeout must be a number')\n  }\n  return true\n}\n\nexport function rpc ({topic, data, resolve, reject, timeout = DEFAULT_TIMEOUT}) {\n  try {\n    validateRpcInput({topic, resolve, reject, data, timeout})\n    let timedout = false\n    const timer = setTimeout(function () {\n      timedout = true\n      reject(new Error(`RPC for ${topic} using ${data} timed out after ${timeout}ms`))\n    }, timeout)\n    const done = (args) => {\n      clearTimeout(timer)\n      if (args.errors) {\n        reject(new Error(JSON.stringify(args.errors)))\n      } else if (!timedout) {\n        resolve(args)\n      }\n    }\n    once(topic, done)\n    emit(topic, data)\n  } catch (e) {\n    reject(e)\n  }\n}\nfunction onNative ({detail: {topic, data}}) {\n  (events[topic] || []).forEach((handler) => handler(data))\n}\n\nexport function setupNativeLink () {\n  window.addEventListener('nativebridge', onNative)\n}\n\nexport function destroy () {\n  Object.keys(events).forEach((topic) => {\n    Object.keys(events[topic]).forEach((handler) => {\n      delete events[topic][handler]\n    })\n    delete events[topic]\n  })\n  if (typeof window !== 'undefined') {\n    window.removeEventListener('nativebridge', onNative)\n  }\n}\n\nif (typeof window !== 'undefined') {\n  setupNativeLink()\n}\n"],"sourceRoot":""}